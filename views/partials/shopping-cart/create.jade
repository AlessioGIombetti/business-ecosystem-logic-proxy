ui-view
  .row
    .col-xs-12
      .breadcrumb-triangle.z-depth-1
        a(ui-sref="offering", ui-sref-opts="{ reload: true, inherit: false }")
          span.item-icon.fa.fa-chevron-left
          span.item-text Back
        a.active
          span.item-icon.fa.fa-share
          span.item-text Checkout
    .col-xs-12
      .panel.panel-default.z-depth-1
        .panel-body(ng-switch="orderVM.loadingStatus")
          .h4
            strong Confirm and checkout
          hr
          form(ng-switch-when="LOADED", name="order.form", novalidate)
            .row
              .col-xs-12
                .form-group
                  label
                    span Enter a description
                    small.text-muted (optional)
                  textarea.form-control(rows="3", name="description", ng-model="orderVM.orderInfo.description")
            .row
              .col-sm-6
                .form-group
                  label
                    span Enter an external ID
                    small.text-muted (optional)
                  input.form-control(
                    type="text"
                    name="ext-id"
                    ng-model="orderVM.orderInfo.externalId"
                  )
              .col-sm-6
                .form-group
                  label
                    span Enter a notification contact
                    small.text-muted (optional)
                  input.form-control(
                    type="email"
                    name="contact"
                    ng-model="orderVM.orderInfo.notificationContact"
                  )
            .row
              .col-xs-12
                .form-group
                  label
                    span Enter a note
                    small.text-muted (optional)
                  textarea.form-control(rows="3", name="note")
            .row
              .col-xs-12
                .h4.text-dark-secondary
                  strong Shopping cart
                .panel-group(id="order-item-list")
                  .panel.panel-default.z-depth-1(ng-repeat="item in orderVM.orderInfo.orderItem")
                    .panel-heading
                      .pull-right
                        strong {{ orderVM.formatPriceplan(item) }}
                      .h4
                        a.btn-block(data-toggle="collapse", data-parent="#order-item-list", data-target="#order-item-{{ $index }}")
                          span.item-text {{ item.productOffering.name }}
                    .panel-collapse.collapse(id="order-item-{{ item.id }}")
                      .panel-body
                        .h4.text-dark-secondary
                          strong Overview
                        .table-responsive
                          table.table.table-bordered
                            thead
                              tr
                                th Quantity
                                th Href
                            tbody
                              tr
                                td.text-dark-secondary x 1
                                td.text-dark-secondary {{ item.productOffering.href }}
                        .h4.text-dark-secondary(ng-if="item.product.productPrice.length")
                          strong Price plan
                        .table-responsive(ng-if="item.product.productPrice.length")
                          table.table.table-bordered
                            thead
                              tr
                                th Name
                                th Price
                            tbody
                              tr
                                td.text-dark-secondary {{ item.product.productPrice[0].name }}
                                td.text-dark-secondary {{ orderVM.formatPriceplan(item) }}
                        .h4.text-dark-secondary(ng-if="item.product.productCharacteristic.length")
                          strong Characteristics
                        .table-responsive(ng-if="item.product.productCharacteristic.length")
                          table.table.table-bordered
                            thead
                              tr
                                th Name
                                th Value
                            tbody
                              tr(ng-repeat="char in item.product.productCharacteristic")
                                td.text-dark-secondary {{ char.name }}
                                td.text-dark-secondary {{ char.value }}
            .form-group.text-right
              a.btn.btn-success.z-depth-1(ng-disabled="!order.form.$valid || orderVM.createOrderStatus == 'LOADING'", ng-click="orderVM.makeOrder()")
                span.item-icon.fa(ng-class="orderVM.createOrderStatus === 'LOADING' ? ['fa-spinner', 'fa-spin'] : 'fa-share'")
                span.item-text Checkout
          div(ng-switch-when="ERROR")
            .alert.alert-danger.text-center {{ orderVM.error }}
          div(ng-switch-default)
            .container-spinner
              span.fa.fa-spinner.fa-spin.fa-2x