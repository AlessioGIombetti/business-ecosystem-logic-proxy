form(name="step.form", novalidate)
  .form-group(ng-class="{ 'has-error': createForm.hasError(step.form.name) }")
    label Enter a name
    input.form-control(
      type="text"
      name="name"
      ng-model="createVM.data.name"
      required
      ng-maxlength="30"
      field-unique="Category"
    )
    .help-block(
      ng-messages="step.form.name.$error"
      ng-show="createForm.hasError(step.form.name)"
    )
      span(ng-message="required") This field is required.
      span(ng-message="maxlength") This field must not exceed 30 chars.
      span(ng-message="unique") This name is already taken.
  .form-group
    label
      span Enter a description
      small.text-muted (optional)
    textarea.form-control(rows="3", name="description", ng-model="createVM.data.description")
  .item-toggle
    label.toggle Choose a root category
      .track
        input(
          type="checkbox"
          ng-model="createVM.data.isRoot"
          ng-true-value="false"
          ng-false-value="true"
          ng-change="createVM.refreshCategories()"
        )
        i.fa.fa-2x
  .table-responsive(ng-if="!createVM.data.isRoot", ng-switch="createVM.status")
    input(type="hidden", ng-model="createVM.data.parentId", required)
    table.table.table-bordered.table-hover.table-selectable(ng-switch-when="LOADED")
      thead
        tr
          th #
          th Name
          th Updated
      tbody
        tr(ng-repeat="category in createVM.roots", ng-class="{ active: createVM.data.parentId == category.id }", ng-click="createVM.setRootCategory(category)")
          th {{ $index }}
          td
            strong {{ category.name }}
          td
            time(am-time-ago="category.lastUpdate")
        tr(ng-repeat="category in createVM.subcategories", ng-class="{ active: createVM.data.parentId == category.id }", ng-click="createVM.setRootCategory(category)")
          th {{ $index }}
          td
            span(ng-repeat="parentCategory in createVM.getBreadcrumbOf(category)") {{ parentCategory.name }} / 
            strong {{ category.name }}
          td
            time(am-time-ago="category.lastUpdate")
  .form-group.text-right
    a.btn.btn-default.z-depth-1(ng-click="createForm.nextStep($index + 1, createVM.stepList[$index + 1])", ng-disabled="!step.form.$valid")
      span.item-text Next